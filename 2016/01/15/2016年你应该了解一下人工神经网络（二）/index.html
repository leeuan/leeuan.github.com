<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>2016年你应该了解一下人工神经网络（二） | Bit Mind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="上篇文章我们介绍了用数学模拟单个神经元而建立的神经元数学模型，这个数学模型可以让我们通过数学运行来实现对数据进行识别，已经某种程度上模拟了生物神经元的工作方式，但是这种模拟并没有太激动人的地方，因为智能的神奇之处在于能够通过学习获取对事物的认知能力。人类具有的生物智能学习能力让人类创建了人类文明，并且能够让人类文明永远的传承下去。所以学习能力对于智能的构成何等重要无需累述。但是鉴于生物大脑结构的复">
<meta property="og:type" content="article">
<meta property="og:title" content="2016年你应该了解一下人工神经网络（二）">
<meta property="og:url" content="http://yoursite.com/2016/01/15/2016年你应该了解一下人工神经网络（二）/index.html">
<meta property="og:site_name" content="Bit Mind">
<meta property="og:description" content="上篇文章我们介绍了用数学模拟单个神经元而建立的神经元数学模型，这个数学模型可以让我们通过数学运行来实现对数据进行识别，已经某种程度上模拟了生物神经元的工作方式，但是这种模拟并没有太激动人的地方，因为智能的神奇之处在于能够通过学习获取对事物的认知能力。人类具有的生物智能学习能力让人类创建了人类文明，并且能够让人类文明永远的传承下去。所以学习能力对于智能的构成何等重要无需累述。但是鉴于生物大脑结构的复">
<meta property="og:image" content="http://yoursite.com/img/bp_net_top.jpg">
<meta property="og:image" content="http://yoursite.com/img/rewiring.png">
<meta property="og:image" content="http://yoursite.com/img/bp_nn.png">
<meta property="og:image" content="http://yoursite.com/img/du.png">
<meta property="og:updated_time" content="2016-01-30T17:04:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2016年你应该了解一下人工神经网络（二）">
<meta name="twitter:description" content="上篇文章我们介绍了用数学模拟单个神经元而建立的神经元数学模型，这个数学模型可以让我们通过数学运行来实现对数据进行识别，已经某种程度上模拟了生物神经元的工作方式，但是这种模拟并没有太激动人的地方，因为智能的神奇之处在于能够通过学习获取对事物的认知能力。人类具有的生物智能学习能力让人类创建了人类文明，并且能够让人类文明永远的传承下去。所以学习能力对于智能的构成何等重要无需累述。但是鉴于生物大脑结构的复">
  
    <link rel="alternative" href="/atom.xml" title="Bit Mind" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://assets.worldwildlife.org/photos/806/images/hero_small/SCR_47384.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Leeuan</a></h1>
		</hgroup>

		
		<p class="header-subtitle">一个需要思考才能存活的胖子</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/categories">分类</a></li>
				        
							<li><a href="/archives">归档</a></li>
				        
							<li><a href="/tags">标签</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/ConvNets/" style="font-size: 10px;">ConvNets</a> <a href="/tags/NLP/" style="font-size: 10px;">NLP</a> <a href="/tags/人工神经网络/" style="font-size: 15px;">人工神经网络</a> <a href="/tags/决策树/" style="font-size: 10px;">决策树</a> <a href="/tags/分类器/" style="font-size: 20px;">分类器</a> <a href="/tags/卷积神经网络/" style="font-size: 10px;">卷积神经网络</a> <a href="/tags/大数据/" style="font-size: 15px;">大数据</a> <a href="/tags/深度学习/" style="font-size: 15px;">深度学习</a> <a href="/tags/随机森林/" style="font-size: 10px;">随机森林</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">一个需要不停和计算机打交道的人，一位父亲，终生学习者</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Leeuan</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://assets.worldwildlife.org/photos/806/images/hero_small/SCR_47384.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Leeuan</h1>
			</hgroup>
			
			<p class="header-subtitle">一个需要思考才能存活的胖子</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/categories">分类</a></li>
		        
					<li><a href="/archives">归档</a></li>
		        
					<li><a href="/tags">标签</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-2016年你应该了解一下人工神经网络（二）" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/15/2016年你应该了解一下人工神经网络（二）/" class="article-date">
  	<time datetime="2016-01-14T16:00:00.000Z" itemprop="datePublished">2016-01-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2016年你应该了解一下人工神经网络（二）
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/人工神经网络/">人工神经网络</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分类器/">分类器</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/机器学习/">机器学习</a>
	</div>


        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/img/bp_net_top.jpg" alt=""></p>
<p>上篇文章我们介绍了用数学模拟单个神经元而建立的神经元数学模型，这个数学模型可以让我们通过数学运行来实现对数据进行识别，已经某种程度上模拟了生物神经元的工作方式，但是这种模拟并没有太激动人的地方，因为智能的神奇之处在于能够通过学习获取对事物的认知能力。人类具有的生物智能学习能力让人类创建了人类文明，并且能够让人类文明永远的传承下去。所以学习能力对于智能的构成何等重要无需累述。但是鉴于生物大脑结构的复杂性和伦理限制，完全揭示生物学习能力的奥秘还需要科学家的加倍努力。</p>
<a id="more"></a>
<p>现在神经科学已经了解了生物大脑学习能力的很多特征，通过一些有趣的实验可以证明通过同样的学习机制生物大脑可以识别不同的信号例如视觉听觉。下面是 Andrew Ng 在斯坦福机器学习公开课上引用的三个例子：</p>
<p><img src="/img/rewiring.png" alt="生物神经元通用性试验"></p>
<p>第1行图片，把三个超声波测距仪通过导线接触人的舌头上，通过训练人可以根据舌头的感觉绕开障碍物。第2行图片第1张图片是把方向传感器通过腰带传递信号给人的腰部，人通过训练依据触觉可以判别方向。最后一张图片，人们给一只青蛙移植了第三只眼睛，通过一段时间的适应，青蛙可以对第三只眼睛看到的移动物体做出正确的反应，说明青蛙的大脑已经学会了处理三只眼睛同时提供的视觉信号。</p>
<p>这些实验证明了人脑中的神经元具有一定的通用性，也就是某种用途的神经元通过训练也能够识别其他用途的信号。所以我们通过数学模拟的神经元也应该具有通用性，其实通过数学可以证明，只要足够多的人工神经元几乎可以拟合出任何非线性输出结果。</p>
<p>神经元是通用的，那么接下来我们就需要思考学习过程能不能通过数学来进行模拟。前面文章介绍的通过信息熵的方式来构建决策树和随机森林已经证明了通过数学我们可以模拟生物的学习过程，但是神经元的学习过程又怎么模拟呢？</p>
<p>上篇文章给出的人工神经元模型，我们已经明确了为了让人工神经元能够工作起来，我们需要给出树突和轴突对应的权重值，那么问题就转化成了通过学习的方式从已经有的数据中计算出权重值。最直接的思路就是把权重值当成未知数，列出方程，然后求解就行了。但是，识别的结果往往只是数据的类别，只能列出不等式方程，并且这些方程并不是唯一解，而我们需要的是唯一解，最好还是最优解。BP神经网络就是一种可以自动从已有数据中解算各种权重的人工神经网络。</p>
<p>接下来，我们来看BP神经网络的结构，下图是BP神经网络的示意图。</p>
<p><img src="/img/bp_nn.png" alt="BP神经网络"></p>
<p>BP（Back Propagation）神经网络是一种多层前馈神经网络。为了方面介绍我们只讨论三层的情况。如上图所示，三层分分别为输入层、隐藏层、输出层。</p>
<ul>
<li>输入层: 接收输入数据不做运算和处理，只会把数据和信号传递给隐藏层，输入层的每个节点都会将信号传递给隐藏层的每个神经元，输入层的节点数量与输入的信号维度相同；</li>
<li>隐藏层: 包含多个人工神经元，每个神经元接收多个输入节点的信号并把这些信号的值与接收树突的权重相乘并累加起来，最后调用sigmoid函数输出给输出层。</li>
<li>输出层：隐藏层的每个神经元把sigmoid的结果传递给每个输出层的神经元，输出层和隐藏层一样会进行权重相乘并累加的处理，最后调用sigmoid函数作为整个神经网络的输出。</li>
</ul>
<p>BP神经网络训练算法的基本思路就是<strong>不断循环调整各个神经元树突的权重值，使得BP神经网络的输出与训练样本期望值的误差最小。</strong> 按照这个思路我们需要用一个函数来衡量误差，还需要找到一个数学方法来调整各个权重值。</p>
<p>有多种函数可以衡量BP神经网络的输出误差，衡量输出误差的函数被称为代价函数（Cost Function）,最常见的代价函数为二次代价函数和交叉熵代价函数。</p>
<p>二次代价函数: </p>
<p>$$E=\frac{1}{2}(y-O)^{2}$$</p>
<p>训练时我们通常是需要衡量一批数据的误差，批量数据的二次代价函数为：</p>
<p>$$E=\frac{1}{2}\sum_{k}^{l}(y-O)^{2}$$</p>
<p>公式中的O表示就是各层的输出，y表示训练数据的标注的分类。现在的求解树突权重的问题可以转变为求解当二次代价函数取最小值时各个树突权重的值。我们可以采用梯度下降算法来求解各个树突的权重。梯度下降算法的思路就是按一定的步长不断调整权重值让代价函数的值变小。</p>
<p><img src="/img/du.png" alt="梯度下降"></p>
<p>如上图，可以把代价函数看成一个曲面（大部分情况树突的权重值的数量不止3个，所以代价函数应该是一个超平面），为了找到最小值我们可以按照代价函数梯度下降最快的方向不断尝试调整树突的权重，最终找到整个曲面的最低点，也就是梯度不再下降的点。</p>
<p>下面我们将直接给出权重调整的公式。</p>
<p>激励函数sigmoid关于x导数为：<br> $${f}’(W)=\frac{\partial f}{\partial W_{ij}}=O_{ij}(1-O_{ij})$$</p>
<p>输出层权重调整公式：</p>
<p>  $$\delta _{o}=\frac{\partial E}{\partial W_{i}}=O_{j}(1-O_j)(y_{j}-O_{j})$$</p>
<p>隐患层权重调整公式：</p>
<p>$$\delta _{h}={f}’(W)(\sum W_{ij}\delta _{o})$$</p>
<p>上面公式中i表示权重的下标，j表示神经网络的层次。每一个训练批次，调整权重的公式为：</p>
<p>$$W_{ij} = W_{ij}-\eta \delta W_{ij}$$</p>
<p>上面公式中$\eta$ 表示学习率也就是我们每次尝试调整权重的步长，如果步长太大，容易错过代价函数的最小值从而得不到权重的最优解，一般情况下我们会把 $\eta$ 设置为0-1之间的一个值。从上面的公式可以看出调整权重的过程就是分别计算出$\delta _{o}$和$\delta _{h}$,然后权重减去用$\delta _{o}$和$\delta _{h}$乘以对应层的权重。清楚了计算公式以后，接着我们来看训练过程。</p>
<p>BP神经网络的训练过程分成两个阶段：</p>
<ul>
<li><strong>向前传递</strong>：对于一批数据从输入层接收数据然后传递给隐藏层，隐藏层又传递给输出层，最后得到输出层激励函数的输出；</li>
<li><strong>向后传递</strong>：根据网络的输出和训练数据的标注计算出权重的调整值，然后对各层的权重就行调整；</li>
</ul>
<p>其实，数学理论可能会让你头晕，但是看看具体的代码看起来就清晰多了，,只采用了不到60行代码就是实现了一个简单明了的BP神经网络。</p>
<pre><code class="python"><span class="comment"># coding: utf-8</span>

<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># 隐藏层神经元数量</span>
hiddenSize = <span class="number">32</span>


<span class="comment"># 激励函数</span>
<span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span>
    output = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))
    <span class="keyword">return</span> output


<span class="comment"># 激励函数的导数</span>
<span class="function"><span class="keyword">def</span> <span class="title">sigmoid_derivative</span><span class="params">(output)</span>:</span>
    <span class="keyword">return</span> output * (<span class="number">1</span> - output)


<span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">(X, y)</span>:</span>

    np.random.seed(<span class="number">1</span>)
    <span class="comment"># 学习率</span>
    eta = <span class="number">0.01</span>
    <span class="comment"># 随机初始化隐藏层和输出层的权重，让权重的平均值为0</span>
    synapse_hidden = <span class="number">2</span> * np.random.random((<span class="number">3</span>, hiddenSize)) - <span class="number">1</span>
    synapse_output = <span class="number">2</span> * np.random.random((hiddenSize, <span class="number">1</span>)) - <span class="number">1</span>

    <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">60000</span>):

        <span class="comment"># 向前传播计算出各层输出</span>
        layer_input = X
        layer_hidden = sigmoid(np.dot(layer_input, synapse_hidden))
        layer_output = sigmoid(np.dot(layer_hidden, synapse_output))

        <span class="keyword">if</span> (j % <span class="number">10000</span>) == <span class="number">0</span>:
            layer_output_error = layer_output - y
            <span class="keyword">print</span> <span class="string">"Error after "</span> + str(j) + <span class="string">" iterations:"</span> + str(np.mean(np.abs(layer_output_error)))

        <span class="comment"># 计算输出层调整值</span>
        layer_output_delta = (layer_output - y) * sigmoid_derivative(layer_output)
        <span class="comment"># 计算隐藏层调整值</span>
        layer_hidden_delta = layer_output_delta.dot(synapse_output.T) * sigmoid_derivative(layer_hidden)
        <span class="comment"># 调整权重</span>
        synapse_output -= eta * (layer_hidden.T.dot(layer_output_delta))
        synapse_hidden -= eta * (layer_input.T.dot(layer_hidden_delta))

X = np.array([[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],
              [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>],
              [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],
              [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]])

y = np.array([[<span class="number">0</span>],
              [<span class="number">1</span>],
              [<span class="number">1</span>],
              [<span class="number">0</span>]])

train(X, y)
</code></pre>
<p>上面的代码已经非常清晰了。</p>
<p>上面的代码已经是一个可以运行的BP神经网络了，但是这段代码并不能真正地应用于实际工程应用，由于这段代码忽略了偏置值，另外由于BP神经网络涉及到的权重比较多容易过拟合，为了解决容易过拟合问题需要采用Dropout技术，每一批次数据都随机放弃更新部分权重。</p>
<p>接下总结一下BP神经网络的优缺点和应用情况。</p>
<p>BP神经网络有以下的一些优点：</p>
<ul>
<li>泛化能力，BP神经网络的泛化能力是指当向网络输入一些训练时未曾遇到的样本时，它可以正确地将未知样本进行分类和预测等，也就是完成由输入空间到输出空间的正确映射，泛化能力也是衡量一个模型性能优劣的重要因素，BP神经网络通过实践证明有较好的泛化能力。</li>
<li>容错能力，BP神经网络的容错能力是指允许输入样本带有个别误差，因为神经网络的训练过程也是一个提取统计特征的过程，个别的误差不会影响到整个网络的训练。</li>
</ul>
<p>BP神经网络在实际的应用中也存在着以下的缺点：</p>
<ul>
<li>容易陷入局部极小而得不到全局最优。在实际的计算中，我们希望BP网络可以找到全局最优点，但往往它会陷入局部最优点，这也表明问题的主要特征没有被网络所提取出来。在这种情况下，通常通过初始化权值再重新训练一遍的方面可以避免，也可以采用Dropout方法放弃更新一些权重。</li>
<li>收敛速度慢。由于BP神经网络的优化方法是梯度下降法，它所要优化的目标函数是一个复杂的非线性函数，因此训练次数多，而且由于误差曲面上有平坦区域，在这些区域中，误差的梯度变化不大，这也使得收敛速度变慢。</li>
<li>缺乏理论指导。目前BP神经网络的建模一般都是根据以有的经验设置网络参数，比如隐层的层数，隐层的节点个数等，这些参数只能根据人工经验调整。</li>
</ul>
<p>BP神经网络由于被应用于卷积神经网络，递归神经网络的最后部分，所以BP神经网络的应用现在越来越广泛，人脸识别，语音识别，人工智能问答等领域都离不开BP神经网络的应用。有关其应用的最新新闻是Facebook研究围棋算法的负责人透露使用过深度卷积神经网络的训练的模型已经可以战胜围棋业务6段选手。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/01/26/当自然语言遇到深度学习/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          当自然语言遇到深度学习
        
      </div>
    </a>
  
  
    <a href="/2016/01/13/2016年你应该了解一下人工神经网络（一）/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">2016年你应该了解一下人工神经网络（一）</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>








</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Leeuan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>
</html>